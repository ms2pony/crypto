import random
def list2Int(a_list,radix):
    a=0
    i=0
    for x in a_list:
        a+=x*radix**i
        i+=1
    return a
def int2list(a,radix):
    a_list=[]
    while a:
        a_list.append(a%radix)
        a//=radix
    return a_list

A_bn=0xca1057100d08b95142ca8a6df06b95da79e786bb95e154e6311fb97e75402ac6
B_bn=0x2e3c3470e1d6ea4d43b6ed9c82c2a43af7039dd7ef26dd286d9712ce603c4cb6

A=int2list(A_bn,2**26)
B=int2list(B_bn,2**26)
# print(A)
# print(B)


T_1=[0]*19

N=2**256-2**224-2**96+2**64-1 # p_sm2
R_inv=0x4fffffff700000005fffffffc00000002fffffff90000000afffffff90000000
N_1=0x4fffffffc00000001fffffffe00000000ffffffff000000010000000000000001
R=2**260

T_1[0]=A[0]*B[0]
t0=T_1[0]
T0=t0&(2**26-1)
T_1[1]=A[0]*B[1]+A[1]*B[0]
t1=T_1[1]
T1_1=t1+(t0>>26)
T1=T1_1&(2**26-1)
T_1[2]=A[0]*B[2]+A[1]*B[1]+A[2]*B[0]
t2=T_1[2]+(T0<<12)
T2_1=t2+(T1_1>>26)
T2=T2_1&(2**26-1)
T_1[3]=A[0]*B[3]+A[1]*B[2]+A[2]*B[1]+A[3]*B[0]
t3=T_1[3]-(T0<<18)+(T1<<12)
T3_1=t3+(T2_1>>26)
T3=T3_1&(2**26-1)
T_1[4]=A[0]*B[4]+A[1]*B[3]+A[2]*B[2]+A[3]*B[1]+A[4]*B[0]
t4=T_1[4]-(T1<<18)+(T2<<12)
T4_1=t4+(T3_1>>26)
T4=T4_1&(2**26-1)
T_1[5]=A[0]*B[5]+A[1]*B[4]+A[2]*B[3]+A[3]*B[2]+A[4]*B[1]+A[5]*B[0]
t5=T_1[5]-(T2<<18)+(T3<<12)
T5_1=t5+(T4_1>>26)
T5=T5_1&(2**26-1)
T_1[6]=A[0]*B[6]+A[1]*B[5]+A[2]*B[4]+A[3]*B[3]+A[4]*B[2]+A[5]*B[1]+A[6]*B[0]
t6=T_1[6]-(T3<<18)+(T4<<12)
T6_1=t6+(T5_1>>26)
T6=T6_1&(2**26-1)
T_1[7]=A[0]*B[7]+A[1]*B[6]+A[2]*B[5]+A[3]*B[4]+A[4]*B[3]+A[5]*B[2]+A[6]*B[1]+A[7]*B[0]
t7=T_1[7]-(T4<<18)+(T5<<12)
T7_1=t7+(T6_1>>26)
T7=T7_1&(2**26-1)
T_1[8]=A[0]*B[8]+A[1]*B[7]+A[2]*B[6]+A[3]*B[5]+A[4]*B[4]+A[5]*B[3]+A[6]*B[2]+A[7]*B[1]+A[8]*B[0]
t8=T_1[8]-(T0<<16)-(T5<<18)+(T6<<12)
T8_1=t8+(T7_1>>26)
T8=T8_1&(2**26-1)
T_1[9]=A[0]*B[9]+A[1]*B[8]+A[2]*B[7]+A[3]*B[6]+A[4]*B[5]+A[5]*B[4]+A[6]*B[3]+A[7]*B[2]+A[8]*B[1]+A[9]*B[0]
t9=T_1[9]+(T0<<22)-(T1<<16)-(T6<<18)+(T7<<12)
T9_1=t9+(T8_1>>26)
T9=T9_1&(2**26-1)
T_1[10]=A[1]*B[9]+A[2]*B[8]+A[3]*B[7]+A[4]*B[6]+A[5]*B[5]+A[6]*B[4]+A[7]*B[3]+A[8]*B[2]+A[9]*B[1]
t10=T_1[10]+(T1<<22)-(T2<<16)-(T7<<18)+(T8<<12)
T_1[11]=A[2]*B[9]+A[3]*B[8]+A[4]*B[7]+A[5]*B[6]+A[6]*B[5]+A[7]*B[4]+A[8]*B[3]+A[9]*B[2]
t11=T_1[11]+(T2<<22)-(T3<<16)-(T8<<18)+(T9<<12)
T_1[12]=A[3]*B[9]+A[4]*B[8]+A[5]*B[7]+A[6]*B[6]+A[7]*B[5]+A[8]*B[4]+A[9]*B[3]
t12=T_1[12]+(T3<<22)-(T4<<16)-(T9<<18)
T_1[13]=A[4]*B[9]+A[5]*B[8]+A[6]*B[7]+A[7]*B[6]+A[8]*B[5]+A[9]*B[4]
t13=T_1[13]+(T4<<22)-(T5<<16)
T_1[14]=A[5]*B[9]+A[6]*B[8]+A[7]*B[7]+A[8]*B[6]+A[9]*B[5]
t14=T_1[14]+(T5<<22)-(T6<<16)
T_1[15]=A[6]*B[9]+A[7]*B[8]+A[8]*B[7]+A[9]*B[6]
t15=T_1[15]+(T6<<22)-(T7<<16)
T_1[16]=A[7]*B[9]+A[8]*B[8]+A[9]*B[7]
t16=T_1[16]+(T7<<22)-(T8<<16)
T_1[17]=A[8]*B[9]+A[9]*B[8]
t17=T_1[17]+(T8<<22)-(T9<<16)
T_1[18]=A[9]*B[9]
t18=T_1[18]+(T9<<22)

T10_1=t10+(T9_1>>26)
R0=T10_1&(2**26-1)
T11_1=t11+(T10_1>>26)
R1=T11_1&(2**26-1)
T12_1=t12+(T11_1>>26)
R2=T12_1&(2**26-1)
T13_1=t13+(T12_1>>26)
R3=T13_1&(2**26-1)
T14_1=t14+(T13_1>>26)
R4=T14_1&(2**26-1)
T15_1=t15+(T14_1>>26)
R5=T15_1&(2**26-1)
T16_1=t16+(T15_1>>26)
R6=T16_1&(2**26-1)
T17_1=t17+(T16_1>>26)
R7=T17_1&(2**26-1)
T18_1=t18+(T17_1>>26)
R8=T18_1&(2**26-1)
R9=T18_1>>26

R=[R0,R1,R2,R3,R4,R5,R6,R7,R8,R9]

print(R)

res=A_bn*B_bn*R_inv%N
print(int2list(res,2**26))